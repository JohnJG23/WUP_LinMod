---
title: "linear model from Web"
author: "John Garza"
date: "Spring 2023"
output:
   html_document:
         toc: true
         toc_depth: 5
        
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Read about the data from the website where it is staged.  Then form three regression models; Model1 is SIMS~ARM, Model2 is SIMS~GRIP, and Model3 is SIMS~ARM+GRIP. For each model find a 95% prediction interval of SIMS given a value of 94  for GRIP and 88 for ARM. Compare Model1 with Model3 using anova. Write it up in a markdown document, push the project up to your github account and submit it back to canvas as link. 

 


```{r include=FALSE}
require(tidyverse)
require(tigerstats)
require(rgl)
require(knitr)

```

```{r}
data <- read.csv(file="https://onlinestatbook.com/case_studies_rvls/physical_strength/data.txt",sep="",header=TRUE)  

```

## Model 1 SIM~ARMS

### scatterplot

```{r}
basicNN <- ggplot(data,aes(y=SIMS,x=ARM))
```

```{r}
basicNN + geom_point() + ggtitle("SIMS vs ARM") + theme(plot.title = element_text(hjust = 0.5, size = 20))
```

The code generated a representation of the data for the relationship between isometric strength tests and job performance for 147 workers. That is why the scatter plot is skewed. Most participant plots landed in the middle with some participants who managed to plot themselves on the outside of the average range.  



### Numerical results
```{r}
cor(SIMS~ARM,data=data)
```
This model is a representation of the correlation between the data. This is why the scatter plot looks the way it looks.

### Inferential  (Build model.1)
```{r}
model.1 <- lm(SIMS~ARM,data=data)
summary.lm(model.1)
```
The response from this model is a SIMS value of "-4.095160". This is because the number would represent where a line would cut across the y axis.

#### Predict at target point
```{r}
tgtpoint=data.frame(ARM=88, GRIP=94)
predict(model.1, tgtpoint, interval= c("prediction"))
```

The response from the rcommand predict shows the representation of a 95% prediction interval. That is why the number 0.7063836 is between -1.726209 and 3.138977.

#### scatterplot with model fit

```{r}
basicNN + geom_point() + ggtitle("SIMS vs ARM") + theme(plot.title = element_text(hjust = 0.5, size = 20)) + geom_smooth(method=lm)
```
  
The r code for a scatter plot with a model fit generates a representation of the data for the relationship between isometric strength tests and job performance for the 147 workers. Overall, a scatter plot with a model fit is a useful base to go from. The model fit graphs the best participants plots on the scatter plot. That is why there a line with participants who landed below and above it.

## Model 2 SIM~GRIP

### Now add in scatterplot

```{r}
basicGRIP <- ggplot(data,aes(y=SIMS,x=GRIP))
```
```{r}
basicGRIP + geom_point() + ggtitle("SIMS vs GRIP") + theme(plot.title = element_text(hjust = 0.5, size = 20))
```


### Numerical results 

```{r}
cor(SIMS~GRIP,data=data)
```
In this numerical response we ran the data to have something to go from. Typically we want to see a number like 0.6398458. Otherwise there would be a non numerical response. 

### Inferential  (Build model.2)

```{r}
model.2 <- lm(SIMS~GRIP,data=data)
summary.lm(model.2)
```
  
When we generate this inferential response it response with estimates. These estimates serve us as an idea of where is the median, max, and minimum. For the variable's SIMS~GRIP we can now consider something like the Residuals, Coefficients, and Intercept.       

#### predict model.2 at target point

```{r}
predict(model.2, tgtpoint, interval= c("prediction"))
```

The response from the rcommand predict shows the representation of a confident prediction interval. That is why the first number in the generated response is -0.5361543 and it falls in between the second and third numbers.

#### now add the model fit to our plot for model.2

```{r}
basicGRIP + geom_point() + ggtitle("SIMS vs GRIP") + theme(plot.title = element_text(hjust = 0.5, size = 20)) + geom_smooth(method=lm)
```  

The r code for a scatter plot with a model fit generates a representation similar to the previous but this one is talking about GRIP. Overall, a scatter plot with a model fit is a useful base to go from. The model fit graphs the best participants plots on the scatter plot. That is why there a line with participants who landed below and above it.

## Model 3 SIM~ARM+GRIP

### Numerical results (cor)

```{r}
cor(SIMS~ARM+GRIP,data=data)
```

  
### Inferential  (Build 2-dimentional model.3)

#### predict model.3 at target point
  

## Comparing nested models ANOVA Test

### Model.1 vs Model.3
### Model.2 vs Model.3

## Informally compare Model.1 with model.2

